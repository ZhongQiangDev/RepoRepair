Let me analyze this step by step:

1. Wrong Behavior:
- idiff() fails when given an equation in Eq() form with an IndexError
- idiff() fails when given f(x) as the dependent variable with a ValueError
- Only works correctly with standard y-x form expressions

2. Cause Analysis:
The main issues appear to be:
- The function doesn't properly handle Eq() objects by not extracting the equation parts correctly
- The function rejects function expressions like f(x) as dependent variables, only accepting simple symbols
- The derivative calculation and substitution logic needs to handle these cases

3. Relevant Files/Functions Analysis:

sympy/core/expr.py:
```
sympy/core/expr.py
class: Expr
```
This class is relevant as it handles core expression manipulation and differentiation that idiff relies on.

sympy/geometry/util.py:
```
sympy/geometry/util.py
function: idiff
```
This is the main function containing the bug that needs to be fixed to handle Eq() and f(x) cases properly.

sympy/solvers/solvers.py:
```
sympy/solvers/solvers.py
function: solve
function: _solve 
```
These functions are relevant as they handle equation solving and manipulation that would be needed to properly process Eq() objects.

The other files contain no relevant functions/classes.

The key functionality that needs modification is in the idiff() function to:
1. Extract equation parts when given an Eq() object
2. Allow function expressions as dependent variables
3. Properly handle the derivative calculations in both cases
