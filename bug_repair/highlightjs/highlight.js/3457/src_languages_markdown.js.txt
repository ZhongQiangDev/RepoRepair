The issue described is that when both bold and italics are applied to a piece of text, the rest of the document renders as bold and italics, ignoring the closing bold/italics characters. This suggests that the regex patterns for bold and italics are not properly handling nested or combined formatting.

To fix this, we need to adjust the regex patterns for bold and italics to ensure they correctly handle nested or combined formatting. Specifically, we need to ensure that the patterns for bold and italics do not interfere with each other when they are used together.

Here is the proposed fix:

```javascript
### src/languages/markdown.js
<<<<<<< SEARCH
  const BOLD = {
    className: 'strong',
    contains: [], // defined later
    variants: [
      {
        begin: /_{2}/,
        end: /_{2}/
      },
      {
        begin: /\*{2}/,
        end: /\*{2}/
      }
    ]
  };
  const ITALIC = {
    className: 'emphasis',
    contains: [], // defined later
    variants: [
      {
        begin: /\*(?!\*)/,
        end: /\*/
      },
      {
        begin: /_(?!_)/,
        end: /_/,
        relevance: 0
      }
    ]
  };
  BOLD.contains.push(ITALIC);
  ITALIC.contains.push(BOLD);
=======
  const BOLD = {
    className: 'strong',
    contains: [], // defined later
    variants: [
      {
        begin: /(?<!\*)\*{2}(?!\*)/,
        end: /(?<!\*)\*{2}(?!\*)/
      },
      {
        begin: /(?<!_)\_{2}(?!_)/,
        end: /(?<!_)\_{2}(?!_)/
      }
    ]
  };
  const ITALIC = {
    className: 'emphasis',
    contains: [], // defined later
    variants: [
      {
        begin: /(?<!\*)\*(?!\*)/,
        end: /(?<!\*)\*(?!\*)/
      },
      {
        begin: /(?<!_)\_(?!_)/,
        end: /(?<!_)\_(?!_)/,
        relevance: 0
      }
    ]
  };
  BOLD.contains.push(ITALIC);
  ITALIC.contains.push(BOLD);
>>>>>>> REPLACE
```

Explanation:
- The regex patterns for bold and italics have been updated to include negative lookbehind and lookahead assertions (`(?<!\*)` and `(?!\*)` for asterisks, and `(?<!_)` and `(?!_)` for underscores). This ensures that the patterns only match when the bold or italic markers are not part of a larger sequence of markers, thus preventing interference when bold and italics are used together.
- This should resolve the issue where the rest of the document renders as bold and italics when both formats are applied to a piece of text.
