```javascript
### src/ol/renderer/Composite.js
<<<<<<< SEARCH
    const layerStatesArray = frameState.layerStatesArray.sort(function (a, b) {
      return a.zIndex - b.zIndex;
    });
=======
    const layerStatesArray = frameState.layerStatesArray.sort(function (a, b) {
      return a.zIndex - b.zIndex;
    }).filter(layerState => layerState.layer.getZIndex() !== undefined);
>>>>>>> REPLACE
```

```javascript
### src/ol/renderer/Composite.js
<<<<<<< SEARCH
      if (
        !inView(layerState, viewState) ||
        (layerState.sourceState != SourceState.READY &&
          layerState.sourceState != SourceState.UNDEFINED)
      ) {
        continue;
      }
=======
      if (
        !inView(layerState, viewState) ||
        (layerState.sourceState != SourceState.READY &&
          layerState.sourceState != SourceState.UNDEFINED) ||
        layerState.layer.getZIndex() === undefined
      ) {
        continue;
      }
>>>>>>> REPLACE
```

```javascript
### src/ol/renderer/Composite.js
<<<<<<< SEARCH
      const layer = layerState.layer;
      const element = layer.render(frameState, previousElement);
      if (!element) {
        continue;
      }
      if (element !== previousElement) {
        this.children_.push(element);
        previousElement = element;
      }
=======
      const layer = layerState.layer;
      const element = layer.render(frameState, previousElement);
      if (!element || layer.getZIndex() === undefined) {
        continue;
      }
      if (element !== previousElement) {
        this.children_.push(element);
        previousElement = element;
      }
>>>>>>> REPLACE
```
